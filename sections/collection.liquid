<div class="container collection-cont">
  <div class="collection-head">
    <div class="collection-title">
      <h1>{{ collection.title }}</h1>
    </div>
    <div class="collection-amount">
      <span class="txt-500 fs-14 cl-black-50 uppercase">({{ collection.products_count }} Products)</span>
    </div>
    <div class="collection-filter">
      <button id="filter-show" class="btn-filter-trigger">
        Filter
        <svg width="14" height="15" viewBox="0 0 14 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3.5 7.5H10.5" stroke="#111111" stroke-width="0.875" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M7 11V4" stroke="#292D32" stroke-width="0.875" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <button class="btn-filter-trigger collection-availability">
        <span>Availability</span>
        <div class="switch">
          <div class="switch-toggle"></div>
        </div>
      </button>
      <button class="btn-filter-trigger">
        Sort By
        <svg width="14" height="15" viewBox="0 0 14 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M11.6199 5.7207L7.81655 9.52404C7.36738 9.9732 6.63238 9.9732 6.18322 9.52404L2.37988 5.7207" stroke="#111111" stroke-width="0.875" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
    </div>
  </div>
  <div class="collection-main">
    {% for product in collection.products %}
      <div class="collection-product">
        <a href="{{ product.url }}" class="collection-product-anchor">
          <svg width="21" height="21" viewBox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5.5 10.5H15.5" stroke="#111111" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M10.5 15.5V5.5" stroke="#111111" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </a>
          
          <!-- Featured Image -->
        <img 
        src="{{ product.featured_image | image_url: width: 320 }}" 
        alt="{{ product.title }}" 
        class="featured-image" 
        />
        <!-- Hover Image -->
        {% if product.images.size > 1 %}
        <img 
          src="{{ product.images[1] | image_url: width: 320 }}" 
          alt="{{ product.title }}" 
          class="hover-image" 
        />
        {% endif %}

        <div class="collection-product-details">
          <div class="collection-product-title">
            <span class="txt-500 fs-16 cl-black">{{ product.title }}</span>
            <span class="txt-400 fs-16 cl-black-50">{{ product.price | money }}</span>
          </div>

         <!-- Variants -->
          <div class="collection-product-variant">
            {% for variant in product.variants %}
              <button 
                class="variant-button" 
                data-variant-id="{{ variant.id }}">
                {{ variant.title }}
              </button>
            {% endfor %}
          </div>
        </div>

      </div>
    {% endfor %}
  </div>
  <div class="collection-popup">
    <div class="collection-popup-filter">
      <div class="collection-popup-filter-head">
        <span>Filters</span>
        <Button id="filter-hide" class="btn-variant">
          <span>Close</span>
        </Button>
      </div>
      {% comment %} <div class="collection-popup-filter-list">
        <div class="filter-variant">
          <div class="filter-variant-head">
            <span>Colors</span>
            <svg width="14" height="15" viewBox="0 0 14 15" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M11.6199 9.2793L7.81655 5.47596C7.36738 5.0268 6.63238 5.0268 6.18322 5.47596L2.37988 9.2793" stroke="#111111" stroke-width="0.875" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="filter-variant-list">
            <button class="filter-variant-list-item btn-variant">
              <div class="color-indicator"></div>
              <span>Black</span>
            </button>
            <button class="filter-variant-list-item btn-variant">
              <div class="color-indicator"></div>
              <span>Black</span>
            </button>
            <button class="filter-variant-list-item btn-variant">
              <div class="color-indicator"></div>
              <span>Black</span>
            </button>
            <button class="filter-variant-list-item btn-variant">
              <div class="color-indicator"></div>
              <span>Black</span>
            </button>
            <button class="filter-variant-list-item btn-variant">
              <div class="color-indicator"></div>
              <span>Black</span>
            </button>
            <button class="filter-variant-list-item btn-variant">
              <div class="color-indicator"></div>
              <span>Black</span>
            </button>
          </div>
        </div>
      </div> {% endcomment %}
      <form class="popup-filter-form">
        {%- for filter in collection.filters -%}

        {% if filter.label != 'Availability' %}
          <details open>
            <summary>
              <div class="filter-variant-head">
                <span class="fs-14 txt-500">{{ filter.label }}</span>
                <svg width="14" height="15" viewBox="0 0 14 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M11.6199 9.2793L7.81655 5.47596C7.36738 5.0268 6.63238 5.0268 6.18322 5.47596L2.37988 9.2793" stroke="#111111" stroke-width="0.875" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
            </summary>

            <div class="filter-variant-list">
              {%- case filter.type -%}
                {%- when 'boolean' -%}
                  <ul class="filter-variant-list">
                      <li class="filter-variant-list-item btn-variant">
                        <label for="Filter-{{ filter.param_name }}-{{ filter.true_value.value }}">
                        <input type="checkbox"
                          name="{{ filter.param_name }}"
                          value="{{ filter.true_value.value }}"
                          id="Filter-{{ filter.param_name }}"
                          {% if filter.true_value.active -%}checked{%- endif %}
                          {% if filter.true_value.count == 0 and filter.true_value.active == false -%}disabled{%- endif -%}
                        >{{ filter.true_value.label }}</label>
                      </li>
                      <li class="filter-variant-list-item btn-variant">
                        <label for="Filter-{{ filter.param_name }}-{{ filter.false_value.value }}">
                        <input type="checkbox"
                          name="{{ filter.param_name }}"
                          value="{{ filter.false_value.value }}"
                          id="Filter-{{ filter.param_name }}"
                          {% if filter.false_value.active -%}checked{%- endif %}
                          {% if filter.false_value.count == 0 and filter.false_value.active == false -%}disabled{%- endif %}
                        >{{ filter.false_value.label }}</label>
                      </li>
                  </ul>

                {%- when 'list' -%}
                  <ul class="filter-variant-list">
                    {%- for filter_value in filter.values -%}
                      <li class="filter-variant-list-item btn-variant {% if forloop.index > 6 %}hidden{% endif %}">
                        {% if filter.label == 'Color' %}
                          <div class="color-indicator" style="background-color: {{ filter_value.label }}"></div>
                        {% endif %}
                        <label class="uppercase fs-14 txt-500" for="Filter-{{ filter.param_name }}-{{ forloop.index }}">
                          <input type="checkbox"
                          name="{{ filter_value.param_name }}"
                          value="{{ filter_value.value }}"
                          id="Filter-{{ filter.param_name }}-{{ forloop.index }}"
                          {% if filter_value.active -%}checked{%- endif %}
                          {% if filter_value.count == 0 and filter_value.active == false -%}disabled{%- endif %}
                          >
                          <span>
                            <span class="visual-display__child"></span>
                          </span>
                          {{ filter_value.label }}
                        </label>
                        <div class="filter-active-indicator"></div>
                      </li>
                    {%- endfor -%}
                    <div 
                      id="show-more-btn" 
                      class="show-more-btn" 
                      {% if filter.values.size <= 6 %}style="display:none;"
                      {% endif %}
                    >
                      Show More
                    </div>
                  </ul>

                {%- when 'price_range' -%}
                  <div class="filter-group-display__price-range">
                    <div class="filter-group-display__price-range-from">
                      <span>{{ cart.currency.symbol }}</span>

                      <input name="{{ filter.min_value.param_name }}"
                        id="Filter-{{ filter.min_value.param_name }}"
                        {% if filter.min_value.value -%}
                          value="{{ filter.min_value.value | money_without_currency | replace: ',', '' }}"
                        {%- endif %}
                        type="number"
                        placeholder="0"
                        min="0"
                        max="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                      >

                      <label for="Filter-{{ filter.min_value.param_name }}">From</label>
                    </div>
                    <div class="filter-group-display__price-range-to">
                      <span>{{ cart.currency.symbol }}</span>

                      <input name="{{ filter.max_value.param_name }}"
                        id="Filter-{{ filter.max_value.param_name }}"
                        {% if filter.max_value.value -%}
                          value="{{ filter.max_value.value | money_without_currency | replace: ',', '' }}"
                        {%- endif %}
                        type="number"
                        placeholder="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                        min="0"
                        max="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                      >

                      <label for="Filter-{{ filter.max_value.param_name }}">To</label>
                    </div>
                  </div>

              {%- endcase -%}
            </div>
          </details>
        {% endif %}
          
        {%- endfor -%}

        <div>
          <div>
            <input type="submit" value="Apply">
          </div>
          <p><a href="{{ collection.url }}?sort_by={{ collection.sort_by }}">Clear all</a></p>

          {%- for filter in collection.filters -%}
            {%- if filter.type == "price_range" -%}
              {%- if filter.min_value.value != nil or filter.max_value.value != nil -%}
                <p>
                  <a href="{{ filter.url_to_remove }}">
                    {%- assign min_value = filter.min_value.value | default: 0 -%}
                    {%- assign max_value = filter.max_value.value | default: filter.range_max -%}
                    {{ min_value | money }} - {{ max_value | money }} X
                  </a>
                </p>
              {%- endif -%}
            {%- else -%}
              {%- for filter_value in filter.active_values -%}
                <p>
                  <a href="{{ filter_value.url_to_remove }}">
                    {{ filter.label }}: {{ filter_value.label }} X
                  </a>
                </p>
              {%- endfor -%}
            {%- endif -%}
          {%- endfor -%}
        </div>
      </form>
    </div>
  </div>
</div>



<script src="{{ "collection.js" |  asset_url }}"></script>

{% schema %}
  {
    "name": "Collection Section",
    "tag": "section",
    "class": "section collection",
    "settings": [
      
    ],
    "blocks": [
    ]
  }
{% endschema %}